{"ast":null,"code":"import _slicedToArray from\"D:/Foodgram/foodgram/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from\"./styles.module.css\";import{useContext,useState}from\"react\";import{LinkComponent}from\"../index.js\";import{AuthContext,UserContext}from\"../../contexts\";import{UserMenu}from\"../../configs/navigation\";import Icons from\"../icons\";import DefaultImage from\"../../images/userpic-icon.jpg\";import{AvatarPopup}from\"../avatar-popup\";import api from\"../../api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AccountData=function AccountData(_ref){var userContext=_ref.userContext,setIsChangeAvatarOpen=_ref.setIsChangeAvatarOpen;return/*#__PURE__*/_jsxs(\"div\",{className:styles.accountProfile,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.accountAvatar,style:{\"background-image\":\"url(\".concat(userContext.avatar||DefaultImage,\")\")},onClick:function onClick(){setIsChangeAvatarOpen(true);}}),/*#__PURE__*/_jsxs(\"div\",{className:styles.accountData,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.accountName,children:[userContext.first_name,\" \",userContext.last_name]}),/*#__PURE__*/_jsx(\"div\",{className:styles.accountEmail,children:userContext.email})]})]});};var AccountMobile=function AccountMobile(_ref2){var onSignOut=_ref2.onSignOut;var authContext=useContext(AuthContext);var userContext=useContext(UserContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isChangeAvatarOpen=_useState2[0],setIsChangeAvatarOpen=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newAvatar=_useState4[0],setNewAvatar=_useState4[1];var handleSaveAvatar=function handleSaveAvatar(){if(newAvatar){api.changeAvatar({file:newAvatar}).then(function(_ref3){var avatar=_ref3.avatar;userContext.avatar=avatar;setIsChangeAvatarOpen(false);}).catch(function(err){return console.log(err);});}else{api.deleteAvatar().then(function(){userContext.avatar=undefined;setIsChangeAvatarOpen(false);}).catch(function(err){return console.log(err);});}};if(!authContext){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:styles.account,children:[/*#__PURE__*/_jsx(AccountData,{userContext:userContext,setIsChangeAvatarOpen:setIsChangeAvatarOpen}),/*#__PURE__*/_jsx(\"div\",{className:styles.accountControls,children:/*#__PURE__*/_jsxs(\"ul\",{className:styles.accountLinks,children:[UserMenu.map(function(menuItem){return/*#__PURE__*/_jsx(\"li\",{className:styles.accountLinkItem,children:/*#__PURE__*/_jsx(LinkComponent,{className:styles.accountLink,href:menuItem.href,title:/*#__PURE__*/_jsxs(\"div\",{className:styles.accountLinkTitle,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.accountLinkIcon,children:menuItem.icon}),menuItem.title]})})});}),/*#__PURE__*/_jsxs(\"li\",{className:styles.accountLinkItem,onClick:onSignOut,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.accountLinkIcon,children:/*#__PURE__*/_jsx(Icons.LogoutMenu,{})}),\"\\u0412\\u044B\\u0439\\u0442\\u0438\"]})]})}),isChangeAvatarOpen&&/*#__PURE__*/_jsx(AvatarPopup,{info:\"test\",avatar:userContext.avatar,onClose:function onClose(){return setIsChangeAvatarOpen(false);},onSubmit:handleSaveAvatar,onChange:setNewAvatar})]});};export default AccountMobile;","map":{"version":3,"names":["styles","useContext","useState","LinkComponent","AuthContext","UserContext","UserMenu","Icons","DefaultImage","AvatarPopup","api","AccountData","userContext","setIsChangeAvatarOpen","accountProfile","accountAvatar","avatar","accountData","accountName","first_name","last_name","accountEmail","email","AccountMobile","onSignOut","authContext","isChangeAvatarOpen","newAvatar","setNewAvatar","handleSaveAvatar","changeAvatar","file","then","catch","err","console","log","deleteAvatar","undefined","account","accountControls","accountLinks","map","menuItem","accountLinkItem","accountLink","href","accountLinkTitle","accountLinkIcon","icon","title"],"sources":["D:/Foodgram/foodgram/frontend/src/components/account-mobile/index.js"],"sourcesContent":["import styles from \"./styles.module.css\";\r\nimport { useContext, useState } from \"react\";\r\nimport { LinkComponent } from \"../index.js\";\r\nimport { AuthContext, UserContext } from \"../../contexts\";\r\nimport { UserMenu } from \"../../configs/navigation\";\r\nimport Icons from \"../icons\";\r\nimport DefaultImage from \"../../images/userpic-icon.jpg\";\r\nimport { AvatarPopup } from \"../avatar-popup\";\r\nimport api from \"../../api\";\r\n\r\nconst AccountData = ({ userContext, setIsChangeAvatarOpen }) => {\r\n  return (\r\n    <div className={styles.accountProfile}>\r\n      <div\r\n        className={styles.accountAvatar}\r\n        style={{\r\n          \"background-image\": `url(${userContext.avatar || DefaultImage})`,\r\n        }}\r\n        onClick={() => {\r\n          setIsChangeAvatarOpen(true);\r\n        }}\r\n      />\r\n      <div className={styles.accountData}>\r\n        <div className={styles.accountName}>\r\n          {userContext.first_name} {userContext.last_name}\r\n        </div>\r\n        <div className={styles.accountEmail}>{userContext.email}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AccountMobile = ({ onSignOut }) => {\r\n  const authContext = useContext(AuthContext);\r\n  const userContext = useContext(UserContext);\r\n  const [isChangeAvatarOpen, setIsChangeAvatarOpen] = useState(false);\r\n  const [newAvatar, setNewAvatar] = useState(\"\");\r\n\r\n  const handleSaveAvatar = () => {\r\n    if (newAvatar) {\r\n      api\r\n        .changeAvatar({ file: newAvatar })\r\n        .then(({ avatar }) => {\r\n          userContext.avatar = avatar;\r\n          setIsChangeAvatarOpen(false);\r\n        })\r\n        .catch((err) => console.log(err));\r\n    } else {\r\n      api\r\n        .deleteAvatar()\r\n        .then(() => {\r\n          userContext.avatar = undefined;\r\n          setIsChangeAvatarOpen(false);\r\n        })\r\n        .catch((err) => console.log(err));\r\n    }\r\n  };\r\n\r\n  if (!authContext) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={styles.account}>\r\n      <AccountData\r\n        userContext={userContext}\r\n        setIsChangeAvatarOpen={setIsChangeAvatarOpen}\r\n      />\r\n      <div className={styles.accountControls}>\r\n        <ul className={styles.accountLinks}>\r\n          {UserMenu.map((menuItem) => {\r\n            return (\r\n              <li className={styles.accountLinkItem}>\r\n                <LinkComponent\r\n                  className={styles.accountLink}\r\n                  href={menuItem.href}\r\n                  title={\r\n                    <div className={styles.accountLinkTitle}>\r\n                      <div className={styles.accountLinkIcon}>\r\n                        {menuItem.icon}\r\n                      </div>\r\n                      {menuItem.title}\r\n                    </div>\r\n                  }\r\n                />\r\n              </li>\r\n            );\r\n          })}\r\n          <li className={styles.accountLinkItem} onClick={onSignOut}>\r\n            <div className={styles.accountLinkIcon}>\r\n              <Icons.LogoutMenu />\r\n            </div>\r\n            Выйти\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      {isChangeAvatarOpen && (\r\n        <AvatarPopup\r\n          info=\"test\"\r\n          avatar={userContext.avatar}\r\n          onClose={() => setIsChangeAvatarOpen(false)}\r\n          onSubmit={handleSaveAvatar}\r\n          onChange={setNewAvatar}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AccountMobile;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}