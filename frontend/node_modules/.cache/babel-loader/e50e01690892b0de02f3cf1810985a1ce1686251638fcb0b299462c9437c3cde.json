{"ast":null,"code":"import _slicedToArray from\"D:/Foodgram/foodgram/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect,useRef}from'react';import styles from'./styles.module.css';import{Button}from'../index';import cn from'classnames';import Icons from'../icons';import DefaultImage from\"../../images/userpic-icon.jpg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FileInput=function FileInput(_ref){var label=_ref.label,onChange=_ref.onChange,_ref$file=_ref.file,file=_ref$file===void 0?null:_ref$file,className=_ref.className,fileSize=_ref.fileSize,fileTypes=_ref.fileTypes;var _useState=useState(file),_useState2=_slicedToArray(_useState,2),currentFile=_useState2[0],setCurrentFile=_useState2[1];var fileInput=useRef(null);useEffect(function(_){if(file!==currentFile){setCurrentFile(file);}},[file]);var getBase64=function getBase64(file){var reader=new FileReader();if(fileSize&&file.size/1000>fileSize){return alert(\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0444\\u0430\\u0439\\u043B \\u0440\\u0430\\u0437\\u043C\\u0435\\u0440\\u043E\\u043C \\u043D\\u0435 \\u0431\\u043E\\u043B\\u0435\\u0435 \".concat(fileSize/1000,\"\\u041C\\u0431\"));}if(fileTypes&&!fileTypes.includes(file.type)){return alert(\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0444\\u0430\\u0439\\u043B \\u043E\\u0434\\u043D\\u043E\\u0433\\u043E \\u0438\\u0437 \\u0442\\u0438\\u043F\\u043E\\u0432: \".concat(fileTypes.join(', ')));}reader.readAsDataURL(file);reader.onload=function(){setCurrentFile(reader.result);onChange(reader.result);};reader.onerror=function(error){console.log('Error: ',error);};};return/*#__PURE__*/_jsxs(\"div\",{className:cn(styles.container,className),children:[label&&/*#__PURE__*/_jsx(\"label\",{className:styles.label,children:label}),/*#__PURE__*/_jsx(\"input\",{className:styles.fileInput,type:\"file\",ref:fileInput,onChange:function onChange(e){var file=e.target.files[0];getBase64(file);}}),/*#__PURE__*/_jsx(Button,{clickHandler:function clickHandler(_){fileInput.current.click();},className:styles.button,type:\"button\",children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u0442\\u044C \\u0444\\u0430\\u0439\\u043B\"}),currentFile&&/*#__PURE__*/_jsx(\"div\",{className:styles.image,style:{backgroundImage:\"url(\".concat(currentFile,\")\")},onClick:function onClick(){onChange(null);setCurrentFile(null);fileInput.current.value=null;},children:/*#__PURE__*/_jsx(\"div\",{className:styles.imageOverlay,children:/*#__PURE__*/_jsx(Icons.ReceiptDelete,{})})})]});};export default FileInput;","map":{"version":3,"names":["useState","useEffect","useRef","styles","Button","cn","Icons","DefaultImage","FileInput","label","onChange","file","className","fileSize","fileTypes","currentFile","setCurrentFile","fileInput","_","getBase64","reader","FileReader","size","alert","includes","type","join","readAsDataURL","onload","result","onerror","error","console","log","container","e","target","files","current","click","button","image","backgroundImage","value","imageOverlay"],"sources":["D:/Foodgram/foodgram/frontend/src/components/file-input/index.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react'\r\nimport styles from './styles.module.css'\r\nimport { Button } from '../index'\r\nimport cn from 'classnames'\r\nimport Icons from '../icons'\r\nimport DefaultImage from \"../../images/userpic-icon.jpg\"\r\n\r\nconst FileInput = ({\r\n  label,\r\n  onChange,\r\n  file = null,\r\n  className,\r\n  fileSize,\r\n  fileTypes\r\n}) => {\r\n  const [ currentFile, setCurrentFile ] = useState(file)\r\n  const fileInput = useRef(null)\r\n\r\n  useEffect(_ => {\r\n    if (file !== currentFile) {\r\n      setCurrentFile(file)\r\n    }\r\n  }, [file])\r\n\r\n  const getBase64 = (file) => {\r\n    const reader = new FileReader()\r\n\r\n    if (fileSize && ((file.size / 1000) > fileSize)) {\r\n      return alert(`Загрузите файл размером не более ${fileSize / 1000}Мб`)\r\n    }\r\n    if (fileTypes && !fileTypes.includes(file.type)) {\r\n      return alert(`Загрузите файл одного из типов: ${fileTypes.join(', ')}`)\r\n    }\r\n    reader.readAsDataURL(file);\r\n    reader.onload = function () {\r\n      setCurrentFile(reader.result)\r\n      onChange(reader.result)\r\n    };\r\n    reader.onerror = function (error) {\r\n      console.log('Error: ', error);\r\n    }\r\n  }\r\n\r\n  return <div className={cn(styles.container, className)}>\r\n    {label && <label className={styles.label}>\r\n      {label}\r\n    </label>}\r\n    <input\r\n      className={styles.fileInput}\r\n      type='file'\r\n      ref={fileInput}\r\n      onChange={e => {\r\n        const file = e.target.files[0]\r\n        getBase64(file)\r\n      }}\r\n    />\r\n    <Button\r\n      clickHandler={_ => {\r\n        fileInput.current.click()\r\n      }}\r\n      className={styles.button}\r\n      type='button'\r\n    >\r\n      Выбрать файл\r\n    </Button>\r\n    {currentFile && <div\r\n      className={styles.image}\r\n      style={{\r\n        backgroundImage: `url(${currentFile})`\r\n      }}\r\n      onClick={() => {\r\n        onChange(null)\r\n        setCurrentFile(null)\r\n        fileInput.current.value = null\r\n      }}\r\n    >\r\n      <div className={styles.imageOverlay}>\r\n        <Icons.ReceiptDelete />\r\n      </div>\r\n    </div>}\r\n  </div>\r\n}\r\n\r\nexport default FileInput"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}