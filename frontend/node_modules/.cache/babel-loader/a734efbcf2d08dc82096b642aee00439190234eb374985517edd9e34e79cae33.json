{"ast":null,"code":"import _slicedToArray from\"D:/Foodgram/foodgram/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{useTags}from'./index.js';import api from'../api';export default function useRecipes(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),recipes=_useState2[0],setRecipes=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),recipesCount=_useState4[0],setRecipesCount=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),recipesPage=_useState6[0],setRecipesPage=_useState6[1];var handleLike=function handleLike(_ref){var id=_ref.id,_ref$toLike=_ref.toLike,toLike=_ref$toLike===void 0?true:_ref$toLike;var method=toLike?api.addToFavorites.bind(api):api.removeFromFavorites.bind(api);method({id:id}).then(function(res){var recipesUpdated=recipes.map(function(recipe){if(recipe.id===id){recipe.is_favorited=toLike;}return recipe;});setRecipes(recipesUpdated);}).catch(function(err){var errors=err.errors;if(errors){alert(errors);}});};var handleAddToCart=function handleAddToCart(_ref2){var id=_ref2.id,_ref2$toAdd=_ref2.toAdd,toAdd=_ref2$toAdd===void 0?true:_ref2$toAdd,callback=_ref2.callback;var method=toAdd?api.addToOrders.bind(api):api.removeFromOrders.bind(api);method({id:id}).then(function(res){var recipesUpdated=recipes.map(function(recipe){if(recipe.id===id){recipe.is_in_shopping_cart=toAdd;}return recipe;});setRecipes(recipesUpdated);callback&&callback(toAdd);}).catch(function(err){var errors=err.errors;if(errors){alert(errors);}});};return{recipes:recipes,setRecipes:setRecipes,recipesCount:recipesCount,setRecipesCount:setRecipesCount,recipesPage:recipesPage,setRecipesPage:setRecipesPage,handleLike:handleLike,handleAddToCart:handleAddToCart};}","map":{"version":3,"names":["React","useState","useTags","api","useRecipes","recipes","setRecipes","recipesCount","setRecipesCount","recipesPage","setRecipesPage","handleLike","id","toLike","method","addToFavorites","bind","removeFromFavorites","then","res","recipesUpdated","map","recipe","is_favorited","catch","err","errors","alert","handleAddToCart","toAdd","callback","addToOrders","removeFromOrders","is_in_shopping_cart"],"sources":["D:/Foodgram/foodgram/frontend/src/utils/use-recipes.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useTags } from './index.js'\r\nimport api from '../api'\r\n\r\nexport default function useRecipes () {\r\n  const [ recipes, setRecipes ] = useState([])\r\n  const [ recipesCount, setRecipesCount ] = useState(0)\r\n  const [ recipesPage, setRecipesPage ] = useState(1)\r\n\r\n  const handleLike = ({ id, toLike = true }) => {\r\n    const method = toLike ? api.addToFavorites.bind(api) : api.removeFromFavorites.bind(api)\r\n    method({ id }).then(res => {\r\n      const recipesUpdated = recipes.map(recipe => {\r\n        if (recipe.id === id) {\r\n          recipe.is_favorited = toLike\r\n        }\r\n        return recipe\r\n      })\r\n      setRecipes(recipesUpdated)\r\n    })\r\n    .catch(err => {\r\n      const { errors } = err\r\n      if (errors) {\r\n        alert(errors)\r\n      }\r\n    })\r\n  }\r\n\r\n  const handleAddToCart = ({ id, toAdd = true, callback }) => {\r\n    const method = toAdd ? api.addToOrders.bind(api) : api.removeFromOrders.bind(api)\r\n    method({ id }).then(res => {\r\n      const recipesUpdated = recipes.map(recipe => {\r\n        if (recipe.id === id) {\r\n          recipe.is_in_shopping_cart = toAdd\r\n        }\r\n        return recipe\r\n      })\r\n      setRecipes(recipesUpdated)\r\n      callback && callback(toAdd)\r\n    })\r\n    .catch(err => {\r\n      const { errors } = err\r\n      if (errors) {\r\n        alert(errors)\r\n      }\r\n    })\r\n  }\r\n\r\n  return {\r\n    recipes,\r\n    setRecipes,\r\n    recipesCount,\r\n    setRecipesCount,\r\n    recipesPage,\r\n    setRecipesPage,\r\n    handleLike,\r\n    handleAddToCart,\r\n  }\r\n}\r\n"],"mappings":"uJAAA,MAAOA,MAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,OAAO,KAAQ,YAAY,CACpC,MAAOC,IAAG,KAAM,QAAQ,CAExB,cAAe,SAASC,WAAU,EAAI,CACpC,cAAgCH,QAAQ,CAAC,EAAE,CAAC,wCAApCI,OAAO,eAAEC,UAAU,eAC3B,eAA0CL,QAAQ,CAAC,CAAC,CAAC,yCAA7CM,YAAY,eAAEC,eAAe,eACrC,eAAwCP,QAAQ,CAAC,CAAC,CAAC,yCAA3CQ,WAAW,eAAEC,cAAc,eAEnC,GAAMC,WAAU,CAAG,QAAbA,WAAU,MAA8B,IAAxBC,GAAE,MAAFA,EAAE,kBAAEC,MAAM,CAANA,MAAM,sBAAG,IAAI,aACrC,GAAMC,OAAM,CAAGD,MAAM,CAAGV,GAAG,CAACY,cAAc,CAACC,IAAI,CAACb,GAAG,CAAC,CAAGA,GAAG,CAACc,mBAAmB,CAACD,IAAI,CAACb,GAAG,CAAC,CACxFW,MAAM,CAAC,CAAEF,EAAE,CAAFA,EAAG,CAAC,CAAC,CAACM,IAAI,CAAC,SAAAC,GAAG,CAAI,CACzB,GAAMC,eAAc,CAAGf,OAAO,CAACgB,GAAG,CAAC,SAAAC,MAAM,CAAI,CAC3C,GAAIA,MAAM,CAACV,EAAE,GAAKA,EAAE,CAAE,CACpBU,MAAM,CAACC,YAAY,CAAGV,MAAM,CAC9B,CACA,MAAOS,OAAM,CACf,CAAC,CAAC,CACFhB,UAAU,CAACc,cAAc,CAAC,CAC5B,CAAC,CAAC,CACDI,KAAK,CAAC,SAAAC,GAAG,CAAI,CACZ,GAAQC,OAAM,CAAKD,GAAG,CAAdC,MAAM,CACd,GAAIA,MAAM,CAAE,CACVC,KAAK,CAACD,MAAM,CAAC,CACf,CACF,CAAC,CAAC,CACJ,CAAC,CAED,GAAME,gBAAe,CAAG,QAAlBA,gBAAe,OAAuC,IAAjChB,GAAE,OAAFA,EAAE,mBAAEiB,KAAK,CAALA,KAAK,sBAAG,IAAI,aAAEC,QAAQ,OAARA,QAAQ,CACnD,GAAMhB,OAAM,CAAGe,KAAK,CAAG1B,GAAG,CAAC4B,WAAW,CAACf,IAAI,CAACb,GAAG,CAAC,CAAGA,GAAG,CAAC6B,gBAAgB,CAAChB,IAAI,CAACb,GAAG,CAAC,CACjFW,MAAM,CAAC,CAAEF,EAAE,CAAFA,EAAG,CAAC,CAAC,CAACM,IAAI,CAAC,SAAAC,GAAG,CAAI,CACzB,GAAMC,eAAc,CAAGf,OAAO,CAACgB,GAAG,CAAC,SAAAC,MAAM,CAAI,CAC3C,GAAIA,MAAM,CAACV,EAAE,GAAKA,EAAE,CAAE,CACpBU,MAAM,CAACW,mBAAmB,CAAGJ,KAAK,CACpC,CACA,MAAOP,OAAM,CACf,CAAC,CAAC,CACFhB,UAAU,CAACc,cAAc,CAAC,CAC1BU,QAAQ,EAAIA,QAAQ,CAACD,KAAK,CAAC,CAC7B,CAAC,CAAC,CACDL,KAAK,CAAC,SAAAC,GAAG,CAAI,CACZ,GAAQC,OAAM,CAAKD,GAAG,CAAdC,MAAM,CACd,GAAIA,MAAM,CAAE,CACVC,KAAK,CAACD,MAAM,CAAC,CACf,CACF,CAAC,CAAC,CACJ,CAAC,CAED,MAAO,CACLrB,OAAO,CAAPA,OAAO,CACPC,UAAU,CAAVA,UAAU,CACVC,YAAY,CAAZA,YAAY,CACZC,eAAe,CAAfA,eAAe,CACfC,WAAW,CAAXA,WAAW,CACXC,cAAc,CAAdA,cAAc,CACdC,UAAU,CAAVA,UAAU,CACViB,eAAe,CAAfA,eACF,CAAC,CACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}